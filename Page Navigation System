--- Creates a new page within a tab.
function BlindHubsUiLibrary:AddPage(pageName)
    if not self.isTab then return end

    local pageFrame = create("Frame", { Name = pageName .. "_Page", Size = UDim2.fromScale(1, 1), Position = UDim2.fromScale(1, 0), BackgroundTransparency = 1, Visible = false, Parent = self.rootPage.page.Parent })
    create("UIListLayout", { Parent = pageFrame, Padding = UDim.new(0, 8), SortOrder = Enum.SortOrder.LayoutOrder, HorizontalAlignment = Enum.HorizontalAlignment.Left })
	create("UIPadding", { Parent = pageFrame, PaddingLeft = UDim.new(0, 10), PaddingRight = UDim.new(0, 10) })

    local backButton = self:AddButton({ Text = "< Back" })
    backButton.Parent = pageFrame
    backButton.Name = "BackButton"
    if backButton:FindFirstChild("ArrowLabel") then backButton.ArrowLabel:Destroy() end

    local pageAPI = { page = pageFrame, window = self.window, isPage = true, rootTab = self, tabName = self.tabName }
    setmetatable(pageAPI, BlindHubsUiLibrary)

    self.pages[pageName] = pageAPI

    backButton.MouseButton1Click:Connect(function() self:NavigateBack() end)

    return pageAPI
end

function BlindHubsUiLibrary:GetCurrentPage()
    return self.pageStack[#self.pageStack]
end

function BlindHubsUiLibrary:NavigateTo(pageAPI)
    local currentPage = self:GetCurrentPage()
    table.insert(self.pageStack, pageAPI)

    local newPage = pageAPI.page
    newPage.Visible = true
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
    TweenService:Create(currentPage.page, tweenInfo, { Position = UDim2.fromScale(-1, 0) }):Play()
    TweenService:Create(newPage, tweenInfo, { Position = UDim2.fromScale(0, 0) }):Play()
    
    task.delay(0.3, function() currentPage.page.Visible = false end)
end

function BlindHubsUiLibrary:NavigateBack()
    if #self.pageStack <= 1 then return end

    local currentPage = table.remove(self.pageStack)
    local previousPage = self:GetCurrentPage()
    previousPage.page.Visible = true
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
    TweenService:Create(currentPage.page, tweenInfo, { Position = UDim2.fromScale(1, 0) }):Play()
    TweenService:Create(previousPage.page, tweenInfo, { Position = UDim2.fromScale(0, 0) }):Play()
    
    task.delay(0.3, function() currentPage.page.Visible = false end)
end
